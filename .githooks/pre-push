#!/bin/bash

# Pre-push Hook for Rust Project
# Run comprehensive checks before pushing

set -e

echo "ğŸš€ Running pre-push checks..."
echo "============================="

# Check if we're in the right directory
if [ ! -f "Cargo.toml" ]; then
    echo "âŒ Error: Run this script from the project root"
    exit 1
fi

echo "âœ… Repository structure verified"

# Run full test suite
echo ""
echo "ğŸ§ª Running full test suite..."
if cargo test --quiet; then
    echo "âœ… All tests passed"
else
    echo "âŒ Tests failed. Fix the issues before pushing."
    exit 1
fi

# Check documentation builds
echo ""
echo "ğŸ“š Building documentation..."
if cargo doc --no-deps --quiet; then
    echo "âœ… Documentation built successfully"
else
    echo "âŒ Documentation build failed. Fix the issues before pushing."
    exit 1
fi

echo ""
echo "ğŸ‰ All pre-push checks passed!"
echo ""

exit 0
